@page "/connectfour"

<h3>Connect Four</h3>

<table class="board">
    @for (int row = 0; row < Rows; row++)
    {
        <tr>
            @for (int col = 0; col < Columns; col++)
            {
                <td @onclick="() => DropPiece(col)" style="background-color:@GetCellColor(row, col)">
                    &nbsp;
                </td>
            }
        </tr>
    }
</table>

<p>@statusMessage</p>

@code {
    private const int Rows = 6;
    private const int Columns = 7;
    private string[,] board = new string[Rows, Columns];
    private bool isPlayerOneTurn = true;
    private string statusMessage = "Player 1's turn";

    private void DropPiece(int column)
    {
        // Find the lowest empty row
        for (int row = Rows - 1; row >= 0; row--)
        {
            if (string.IsNullOrEmpty(board[row, column]))
            {
                board[row, column] = isPlayerOneTurn ? "Red" : "Yellow";
                if (CheckWinner(row, column))
                {
                    statusMessage = $"Player {(isPlayerOneTurn ? 1 : 2)} wins!";
                }
                else
                {
                    isPlayerOneTurn = !isPlayerOneTurn;
                    statusMessage = $"Player {(isPlayerOneTurn ? 1 : 2)}'s turn";
                }
                break;
            }
        }
    }

    private string GetCellColor(int row, int col)
    {
        return board[row, col] ?? "White";
    }

    // You will implement winner-checking logic here
    private bool CheckWinner(int row, int col)
    {
        // Placeholder: returns false for now
        return false;
    }
}
